{"paragraphs":[{"text":"val czasDF = spark.sql(\"SELECT * FROM czas\")\r\nval typyDF = spark.sql(\"SELECT * FROM typy_pojazdow\")\r\nval miejscaDF = spark.sql(\"SELECT * FROM miejsca\")\r\nval pogodaDF = spark.sql(\"SELECT * from pogoda\")\r\nval faktyDF = spark.sql(\"SELECT * from fakty\")","user":"anonymous","dateUpdated":"2021-01-19T11:40:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"czasDF: org.apache.spark.sql.DataFrame = [id: bigint, rok: int ... 5 more fields]\ntypyDF: org.apache.spark.sql.DataFrame = [id: int, typ: string ... 1 more field]\nmiejscaDF: org.apache.spark.sql.DataFrame = [id: bigint, kod_ons_obszaru: string ... 5 more fields]\npogodaDF: org.apache.spark.sql.DataFrame = [id: int, opis_pogody: string]\nfaktyDF: org.apache.spark.sql.DataFrame = [id_czasu: bigint, id_pojazdu: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611013521767_-314836679","id":"20210118-234521_991396959","dateCreated":"2021-01-18T23:45:21+0000","dateStarted":"2021-01-19T10:17:55+0000","dateFinished":"2021-01-19T10:18:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12465","title":"Ładowanie danych"},{"text":"val task1 = faktyDF.\n    join(typyDF, faktyDF(\"id_pojazdu\") === typyDF(\"id\")).\n    join(czasDF, faktyDF(\"id_czasu\") === czasDF(\"id\")).\n    groupBy(\"kategoria\").\n    pivot(\"dzien_tygodnia\").\n    agg(sum(\"liczba_pojazdow\"))\ntask1.createOrReplaceTempView(\"task1\")","user":"anonymous","dateUpdated":"2021-01-19T11:41:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"task1: org.apache.spark.sql.DataFrame = [kategoria: string, Fri: bigint ... 5 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=45","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=46","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=47"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611013617050_1830865314","id":"20210118-234657_1284530817","dateCreated":"2021-01-18T23:46:57+0000","dateStarted":"2021-01-19T10:40:26+0000","dateFinished":"2021-01-19T10:40:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12466","title":"Analiza 1: Ilość przejazdów poszczególnych kategorii pojazdów w zależności od dnia tygodnia"},{"text":"%sql\nselect * from task1","user":"anonymous","dateUpdated":"2021-01-19T11:03:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"kategoria":"string","Fri":"string","Mon":"string","Sun":"string","Thu":"string","Tue":"string","Wed":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"kategoria\tFri\tMon\tSun\tThu\tTue\tWed\nlgvs\t7762919\t6389814\t3477\t7258869\t7059476\t7529138\npedal_cycles\t234267\t225059\t92\t270117\t266007\t274028\nhgvs\t3615393\t3157074\t579\t3714436\t3550449\t3823884\ntwo_wheeled_motor_vehicles\t547618\t413366\t156\t493297\t490666\t513564\nsmaller_cars\t49355038\t37835095\t24967\t43358201\t41937465\t44599781\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=48","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=49","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=50","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=51","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=52","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=53","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=54"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611013873941_1837608875","id":"20210118-235113_565696850","dateCreated":"2021-01-18T23:51:13+0000","dateStarted":"2021-01-19T10:40:34+0000","dateFinished":"2021-01-19T10:40:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12467"},{"text":"val task2 = faktyDF.\n    join(typyDF, faktyDF(\"id_pojazdu\") === typyDF(\"id\")).\n    join(czasDF, faktyDF(\"id_czasu\") === czasDF(\"id\")).\n    join(pogodaDF, faktyDF(\"id_pogody\") === pogodaDF(\"id\")).\n    filter($\"typ\".like(\"two_wheeled_motor_vehicles\")).\n    groupBy(\"opis_pogody\").\n    agg(sum(\"liczba_pojazdow\").as(\"liczba_motocykli\")).\n    filter($\"opis_pogody\" =!= \"null\").\n    orderBy($\"liczba_motocykli\".desc)\ntask2.createOrReplaceTempView(\"task2\")","user":"anonymous","dateUpdated":"2021-01-19T11:42:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"task2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [opis_pogody: string, liczba_motocykli: bigint]\n"}]},"apps":[],"jobName":"paragraph_1611013970387_-1101687577","id":"20210118-235250_1539987018","dateCreated":"2021-01-18T23:52:50+0000","dateStarted":"2021-01-19T11:00:05+0000","dateFinished":"2021-01-19T11:00:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12468","title":"Analiza 2: Ilość przejazdów motocyklowych w zależności od pogody"},{"text":"%sql\nselect * from task2","user":"anonymous","dateUpdated":"2021-01-19T11:16:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"opis_pogody":"string","liczba_motocykli":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"opis_pogody","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"liczba_motocykli","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"opis_pogody\tliczba_motocykli\nFine without high winds\t2137386\nRaining without high winds\t197378\nUnknown\t55717\nOther\t31024\nFine with high winds\t19844\nRaining with high winds\t10819\nFog or mist\t5561\nSnowing without high winds\t657\nSnowing with high winds\t129\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=75","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=76","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=77","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=78"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1611054014438_-1450471775","id":"20210119-110014_391144945","dateCreated":"2021-01-19T11:00:14+0000","dateStarted":"2021-01-19T11:00:28+0000","dateFinished":"2021-01-19T11:00:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12469"},{"text":"val maxPrzejazdow = faktyDF.\n    join(miejscaDF, faktyDF(\"id_miejsca\") === miejscaDF(\"id\")).\n    join(czasDF, faktyDF(\"id_czasu\") === czasDF(\"id\")).\n    groupBy(\"rok\", \"nazwa_drogi\").\n    agg(sum(\"liczba_pojazdow\").as(\"suma_przejazdow\")).\n    groupBy(\"rok\").\n    agg(max(\"suma_przejazdow\").as(\"max_suma\"))\n    \nval task3 = faktyDF.\n    join(miejscaDF, faktyDF(\"id_miejsca\") === miejscaDF(\"id\")).\n    join(czasDF, faktyDF(\"id_czasu\") === czasDF(\"id\")).\n    groupBy(\"rok\", \"nazwa_drogi\").\n    agg(sum(\"liczba_pojazdow\").as(\"suma_przejazdow\")).\n    join(maxPrzejazdow, maxPrzejazdow(\"rok\") === czasDF(\"rok\") && maxPrzejazdow(\"max_suma\") === $\"suma_przejazdow\").\n    select(czasDF(\"rok\"), $\"nazwa_drogi\", $\"suma_przejazdow\").\n    orderBy(czasDF(\"rok\"))\ntask3.createOrReplaceTempView(\"task3\")","user":"anonymous","dateUpdated":"2021-01-19T11:43:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"maxPrzejazdow: org.apache.spark.sql.DataFrame = [rok: int, max_suma: bigint]\ntask3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [rok: int, nazwa_drogi: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1611013558650_-669353463","id":"20210118-234558_1494646090","dateCreated":"2021-01-18T23:45:58+0000","dateStarted":"2021-01-19T11:38:01+0000","dateFinished":"2021-01-19T11:38:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12470","title":"Analiza 3: Najbardziej uczęszczana droga w każdym roku"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"rok":"string","nazwa_drogi":"string","suma_przejazdow":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true}},"commonSetting":{},"keys":[{"name":"rok","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"nazwa_drogi","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611054391802_1117993409","id":"20210119-110631_494589084","dateCreated":"2021-01-19T11:06:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:12471","text":"%sql\nselect * from task3","dateUpdated":"2021-01-19T11:39:28+0000","dateFinished":"2021-01-19T11:38:55+0000","dateStarted":"2021-01-19T11:38:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rok\tnazwa_drogi\tsuma_przejazdow\n2005\tU\t1994840\n2006\tU\t2135757\n2007\tU\t2047482\n2009\tU\t2581335\n2010\tM25\t1267712\n2011\tM25\t1464452\n2012\tM25\t1332252\n2013\tM25\t1606420\n2014\tM25\t1396789\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=122","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=123","http://lab-m.europe-west3-a.c.bigdata-291711.internal:4041/jobs/job?id=124"],"interpreterSettingId":"spark"}}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2021-01-19T11:38:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611056297987_-1462871404","id":"20210119-113817_823563760","dateCreated":"2021-01-19T11:38:17+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14273"}],"name":"Projekt","id":"2FUZ143UN","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}